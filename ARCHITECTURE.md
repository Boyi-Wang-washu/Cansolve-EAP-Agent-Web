# ğŸ—ï¸ é¡¹ç›®æ¶æ„æ–‡æ¡£

æœ¬æ–‡æ¡£è¯¦ç»†æè¿° BNBU EAP Assistant çš„ç³»ç»Ÿæ¶æ„è®¾è®¡ã€‚

---

## ğŸ“ æ•´ä½“æ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      ç”¨æˆ·å±‚ (Users)                      â”‚
â”‚   å­¦ç”Ÿ (Students) | æ•™å¸ˆ (Teachers) | ç®¡ç†å‘˜ (Admins)    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â”‚
                      â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  å‰ç«¯åº”ç”¨ (Frontend)                      â”‚
â”‚         Next.js 14 + React 18 + TypeScript               â”‚
â”‚                                                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”               â”‚
â”‚  â”‚  Pages   â”‚  â”‚Componentsâ”‚  â”‚  Stores  â”‚               â”‚
â”‚  â”‚  è·¯ç”±é¡µé¢ â”‚  â”‚  UIç»„ä»¶  â”‚  â”‚  çŠ¶æ€ç®¡ç† â”‚               â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â”‚ HTTP/REST API
                      â”‚ (JSON)
                      â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  åç«¯åº”ç”¨ (Backend)                       â”‚
â”‚              FastAPI + Python 3.11                       â”‚
â”‚                                                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”               â”‚
â”‚  â”‚   API    â”‚  â”‚ Business â”‚  â”‚   Auth   â”‚               â”‚
â”‚  â”‚  Routes  â”‚  â”‚  Logic   â”‚  â”‚   è®¤è¯   â”‚               â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚                   â”‚                 â”‚
          â–¼                   â–¼                 â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Database   â”‚    â”‚  File Store  â”‚    â”‚  AI Provider â”‚
â”‚  PostgreSQL  â”‚    â”‚   (æœ¬åœ°/OSS)  â”‚    â”‚ (æ‰£å­/æ™ºè°±)  â”‚
â”‚   /SQLite    â”‚    â”‚              â”‚    â”‚  (å¾…æ¥å…¥)    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ”§ æŠ€æœ¯æ ˆè¯¦æƒ…

### å‰ç«¯æŠ€æœ¯æ ˆ

| æŠ€æœ¯ | ç‰ˆæœ¬ | ç”¨é€” |
|------|------|------|
| Next.js | 14.2.5 | React å…¨æ ˆæ¡†æ¶ |
| React | 18.3.1 | UI åº“ |
| TypeScript | 5.5.4 | ç±»å‹å®‰å…¨ |
| TailwindCSS | 3.4.7 | æ ·å¼æ¡†æ¶ |
| Zustand | 4.5.4 | çŠ¶æ€ç®¡ç† |
| React Query | 5.51.1 | æ•°æ®è¯·æ±‚ç®¡ç† |
| Axios | 1.7.2 | HTTP å®¢æˆ·ç«¯ |
| Font Awesome | 6.7.2 | å›¾æ ‡åº“ |

### åç«¯æŠ€æœ¯æ ˆ

| æŠ€æœ¯ | ç‰ˆæœ¬ | ç”¨é€” |
|------|------|------|
| FastAPI | 0.111.0 | Web æ¡†æ¶ |
| Uvicorn | 0.30.1 | ASGI æœåŠ¡å™¨ |
| SQLAlchemy | 2.0.30 | ORM |
| PostgreSQL | - | æ•°æ®åº“ï¼ˆç”Ÿäº§ï¼‰ |
| SQLite | - | æ•°æ®åº“ï¼ˆå¼€å‘ï¼‰ |
| Pydantic | 2.7.4 | æ•°æ®éªŒè¯ |
| python-jose | 3.3.0 | JWT è®¤è¯ |
| httpx | 0.27.0 | å¼‚æ­¥ HTTP å®¢æˆ·ç«¯ |

---

## ğŸ“ ç›®å½•ç»“æ„

```
å…¨æ ˆå¼€å‘V1/
â”‚
â”œâ”€â”€ src/                          # å‰ç«¯æºç 
â”‚   â”œâ”€â”€ app/                      # Next.js App Router
â”‚   â”‚   â”œâ”€â”€ auth/                 # è®¤è¯é¡µé¢
â”‚   â”‚   â”‚   â””â”€â”€ login/            # ç™»å½•é¡µ
â”‚   â”‚   â”œâ”€â”€ dashboard/            # ä»ªè¡¨ç›˜
â”‚   â”‚   â”œâ”€â”€ tutor/                # 1v1 è¾…å¯¼
â”‚   â”‚   â”‚   â”œâ”€â”€ select-material/  # é€‰æ‹©ææ–™
â”‚   â”‚   â”‚   â””â”€â”€ chat/             # å¯¹è¯é¡µé¢
â”‚   â”‚   â”œâ”€â”€ teacher/              # æ•™å¸ˆç«¯
â”‚   â”‚   â”‚   â””â”€â”€ materials/        # ææ–™ç®¡ç†
â”‚   â”‚   â”œâ”€â”€ admin/                # ç®¡ç†å‘˜ç«¯ï¼ˆå ä½ï¼‰
â”‚   â”‚   â”œâ”€â”€ layout.tsx            # æ ¹å¸ƒå±€
â”‚   â”‚   â”œâ”€â”€ page.tsx              # é¦–é¡µ
â”‚   â”‚   â”œâ”€â”€ providers.tsx         # å…¨å±€ Providers
â”‚   â”‚   â””â”€â”€ globals.css           # å…¨å±€æ ·å¼
â”‚   â”‚
â”‚   â”œâ”€â”€ components/               # ç»„ä»¶
â”‚   â”‚   â””â”€â”€ layout/               # å¸ƒå±€ç»„ä»¶
â”‚   â”‚       â”œâ”€â”€ Header.tsx        # é¡¶éƒ¨å¯¼èˆª
â”‚   â”‚       â”œâ”€â”€ Sidebar.tsx       # ä¾§è¾¹æ 
â”‚   â”‚       â””â”€â”€ DashboardLayout.tsx
â”‚   â”‚
â”‚   â”œâ”€â”€ lib/                      # å·¥å…·åº“
â”‚   â”‚   â”œâ”€â”€ api.ts                # API å®¢æˆ·ç«¯
â”‚   â”‚   â””â”€â”€ types.ts              # ç±»å‹å®šä¹‰
â”‚   â”‚
â”‚   â””â”€â”€ store/                    # çŠ¶æ€ç®¡ç†
â”‚       â””â”€â”€ authStore.ts          # è®¤è¯çŠ¶æ€
â”‚
â”œâ”€â”€ backend/                      # åç«¯æºç 
â”‚   â”œâ”€â”€ app/
â”‚   â”‚   â”œâ”€â”€ api/                  # API è·¯ç”±
â”‚   â”‚   â”‚   â””â”€â”€ v1/
â”‚   â”‚   â”‚       â”œâ”€â”€ __init__.py   # API Router
â”‚   â”‚   â”‚       â””â”€â”€ endpoints/    # API ç«¯ç‚¹
â”‚   â”‚   â”‚           â”œâ”€â”€ auth.py   # è®¤è¯
â”‚   â”‚   â”‚           â”œâ”€â”€ materials.py  # ææ–™
â”‚   â”‚   â”‚           â”œâ”€â”€ sessions.py   # ä¼šè¯
â”‚   â”‚   â”‚           â””â”€â”€ ai.py     # AI æ¥å£
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ core/                 # æ ¸å¿ƒé…ç½®
â”‚   â”‚   â”‚   â”œâ”€â”€ config.py         # é…ç½®
â”‚   â”‚   â”‚   â””â”€â”€ security.py       # å®‰å…¨/è®¤è¯
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ db/                   # æ•°æ®åº“
â”‚   â”‚   â”‚   â”œâ”€â”€ database.py       # è¿æ¥
â”‚   â”‚   â”‚   â””â”€â”€ models.py         # æ¨¡å‹
â”‚   â”‚   â”‚
â”‚   â”‚   â””â”€â”€ main.py               # ä¸»åº”ç”¨
â”‚   â”‚
â”‚   â”œâ”€â”€ requirements.txt          # Python ä¾èµ–
â”‚   â””â”€â”€ run.py                    # å¯åŠ¨è„šæœ¬
â”‚
â”œâ”€â”€ ui_pages_496770912770/        # UI åŸå‹å‚è€ƒ
â”‚
â”œâ”€â”€ package.json                  # Node.js é…ç½®
â”œâ”€â”€ tsconfig.json                 # TypeScript é…ç½®
â”œâ”€â”€ tailwind.config.ts            # TailwindCSS é…ç½®
â”œâ”€â”€ next.config.mjs               # Next.js é…ç½®
â”‚
â”œâ”€â”€ README.md                     # é¡¹ç›®è¯´æ˜
â”œâ”€â”€ QUICKSTART.md                 # å¿«é€Ÿå¯åŠ¨
â”œâ”€â”€ DEVELOPMENT.md                # å¼€å‘æŒ‡å—
â”œâ”€â”€ DEPLOYMENT.md                 # éƒ¨ç½²æŒ‡å—
â”œâ”€â”€ ARCHITECTURE.md               # æ¶æ„æ–‡æ¡£
â”‚
â”œâ”€â”€ start.bat                     # Windows å¯åŠ¨è„šæœ¬
â””â”€â”€ start.sh                      # Unix å¯åŠ¨è„šæœ¬
```

---

## ğŸ” è®¤è¯æµç¨‹

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ç”¨æˆ·   â”‚                    â”‚  å‰ç«¯   â”‚                    â”‚  åç«¯   â”‚
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜                    â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜                    â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜
     â”‚                              â”‚                              â”‚
     â”‚ 1. è¾“å…¥ç”¨æˆ·å/å¯†ç              â”‚                              â”‚
     â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                              â”‚
     â”‚                              â”‚                              â”‚
     â”‚                              â”‚ 2. POST /api/v1/auth/login  â”‚
     â”‚                              â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚
     â”‚                              â”‚                              â”‚
     â”‚                              â”‚                              â”‚ 3. éªŒè¯
     â”‚                              â”‚                              â”‚    ç”¨æˆ·
     â”‚                              â”‚                              â”‚
     â”‚                              â”‚ 4. è¿”å› JWT Token + ç”¨æˆ·ä¿¡æ¯ â”‚
     â”‚                              â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
     â”‚                              â”‚                              â”‚
     â”‚                              â”‚ 5. å­˜å‚¨ Token åˆ° localStorageâ”‚
     â”‚                              â”‚                              â”‚
     â”‚ 6. è·³è½¬åˆ° Dashboard           â”‚                              â”‚
     â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                              â”‚
     â”‚                              â”‚                              â”‚
     â”‚                              â”‚ 7. åç»­è¯·æ±‚æºå¸¦ Token         â”‚
     â”‚                              â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚
     â”‚                              â”‚    Authorization: Bearer XXX â”‚
     â”‚                              â”‚                              â”‚
```

**JWT Payload**:
```json
{
  "sub": "s001",           // ç”¨æˆ· ID
  "role": "student",       // ç”¨æˆ·è§’è‰²
  "exp": 1234567890        // è¿‡æœŸæ—¶é—´
}
```

---

## ğŸ’¬ å¯¹è¯æµç¨‹ï¼ˆ1v1 è¾…å¯¼ï¼‰

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  å­¦ç”Ÿ   â”‚         â”‚  å‰ç«¯   â”‚         â”‚  åç«¯   â”‚         â”‚   AI    â”‚
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜
     â”‚                   â”‚                   â”‚                   â”‚
     â”‚ 1. é€‰æ‹©ææ–™        â”‚                   â”‚                   â”‚
     â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                   â”‚                   â”‚
     â”‚                   â”‚                   â”‚                   â”‚
     â”‚                   â”‚ 2. åˆ›å»ºä¼šè¯        â”‚                   â”‚
     â”‚                   â”‚  POST /sessions   â”‚                   â”‚
     â”‚                   â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                   â”‚
     â”‚                   â”‚                   â”‚                   â”‚
     â”‚                   â”‚ 3. è¿”å› session_idâ”‚                   â”‚
     â”‚                   â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                   â”‚
     â”‚                   â”‚                   â”‚                   â”‚
     â”‚ 4. å‘é€æ¶ˆæ¯        â”‚                   â”‚                   â”‚
     â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                   â”‚                   â”‚
     â”‚                   â”‚ 5. POST /ai/chat  â”‚                   â”‚
     â”‚                   â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                   â”‚
     â”‚                   â”‚                   â”‚                   â”‚
     â”‚                   â”‚                   â”‚ 6. è°ƒç”¨ AI API    â”‚
     â”‚                   â”‚                   â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚
     â”‚                   â”‚                   â”‚                   â”‚
     â”‚                   â”‚                   â”‚ 7. AI å“åº”        â”‚
     â”‚                   â”‚                   â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
     â”‚                   â”‚                   â”‚                   â”‚
     â”‚                   â”‚ 8. è¿”å› AI å›å¤   â”‚                   â”‚
     â”‚                   â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                   â”‚
     â”‚                   â”‚                   â”‚                   â”‚
     â”‚ 9. æ˜¾ç¤ºå›å¤        â”‚                   â”‚                   â”‚
     â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                   â”‚                   â”‚
     â”‚                   â”‚                   â”‚                   â”‚
     â”‚ 10. ç»“æŸä¼šè¯       â”‚                   â”‚                   â”‚
     â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                   â”‚                   â”‚
     â”‚                   â”‚ 11. POST /sessions/â”‚                   â”‚
     â”‚                   â”‚     {id}/end      â”‚                   â”‚
     â”‚                   â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                   â”‚
     â”‚                   â”‚                   â”‚                   â”‚
     â”‚                   â”‚                   â”‚ 12. ç”ŸæˆæŠ¥å‘Š      â”‚
     â”‚                   â”‚                   â”‚    (å¼‚æ­¥)         â”‚
     â”‚                   â”‚                   â”‚                   â”‚
```

**æµå¼å“åº”ï¼ˆSSEï¼‰**:
```
Client                    Server
  â”‚                         â”‚
  â”‚ POST /ai/chat/stream    â”‚
  â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚
  â”‚                         â”‚
  â”‚  data: {"delta": "I"}   â”‚
  â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
  â”‚  data: {"delta": " am"} â”‚
  â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
  â”‚  data: {"delta": " ..."}â”‚
  â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
  â”‚  data: {"done": true}   â”‚
  â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
```

---

## ğŸ’¾ æ•°æ®æ¨¡å‹

### ER å›¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚    Users     â”‚         â”‚  Materials   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤         â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ id (PK)      â”‚         â”‚ id (PK)      â”‚
â”‚ name         â”‚         â”‚ code (UNIQUE)â”‚
â”‚ email        â”‚         â”‚ title        â”‚
â”‚ role         â”‚<â”€â”€â”€â”€â”   â”‚ created_by   â”‚
â”‚ class_id     â”‚     â”‚   â”‚ is_active    â”‚
â”‚ created_at   â”‚     â”‚   â”‚ version      â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚   â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚             â”‚          â”‚
       â”‚             â”‚          â”‚ 1:N
       â”‚ 1:N         â”‚          â”‚
       â”‚             â”‚          â–¼
       â”‚             â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
       â”‚             â””â”€â”€â”€â”‚MaterialTexts â”‚
       â”‚                 â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
       â”‚                 â”‚ id (PK)      â”‚
       â”‚                 â”‚ material_id  â”‚
       â”‚                 â”‚ text_full    â”‚
       â”‚                 â”‚ char_count   â”‚
       â”‚                 â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Sessions   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ id (PK)      â”‚
â”‚ user_id (FK) â”‚
â”‚ material_id  â”‚
â”‚ mode         â”‚
â”‚ status       â”‚
â”‚ started_at   â”‚
â”‚ ended_at     â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â”‚ 1:N
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Messages   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ id (PK)      â”‚
â”‚ session_id   â”‚
â”‚ role         â”‚
â”‚ content      â”‚
â”‚ tokens       â”‚
â”‚ created_at   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ”Œ API æ¥å£è®¾è®¡

### è®¤è¯æ¥å£

```
POST   /api/v1/auth/login          # ç”¨æˆ·ç™»å½•
GET    /api/v1/auth/me             # è·å–å½“å‰ç”¨æˆ·ä¿¡æ¯
```

### ææ–™æ¥å£

```
GET    /api/v1/materials           # è·å–ææ–™åˆ—è¡¨
GET    /api/v1/materials/{id}      # è·å–ææ–™è¯¦æƒ…
POST   /api/v1/materials           # åˆ›å»ºææ–™ï¼ˆä¸Šä¼ æ–‡ä»¶ï¼‰
PUT    /api/v1/materials/{id}      # æ›´æ–°ææ–™
DELETE /api/v1/materials/{id}      # åˆ é™¤ææ–™
```

### ä¼šè¯æ¥å£

```
POST   /api/v1/sessions            # åˆ›å»ºä¼šè¯
GET    /api/v1/sessions            # è·å–ä¼šè¯åˆ—è¡¨
GET    /api/v1/sessions/{id}       # è·å–ä¼šè¯è¯¦æƒ…
POST   /api/v1/sessions/{id}/end   # ç»“æŸä¼šè¯
```

### AI æ¥å£

```
POST   /api/v1/ai/chat             # AI å¯¹è¯ï¼ˆéæµå¼ï¼‰
POST   /api/v1/ai/chat/stream      # AI å¯¹è¯ï¼ˆæµå¼ï¼‰
POST   /api/v1/ai/generate-quiz    # ç”Ÿæˆå°æµ‹
POST   /api/v1/ai/generate-report  # ç”ŸæˆæŠ¥å‘Š
```

---

## ğŸš€ æ€§èƒ½ä¼˜åŒ–ç­–ç•¥

### å‰ç«¯ä¼˜åŒ–

1. **ä»£ç åˆ†å‰²**: ä½¿ç”¨ Next.js åŠ¨æ€å¯¼å…¥
2. **å›¾ç‰‡ä¼˜åŒ–**: ä½¿ç”¨ Next/Image ç»„ä»¶
3. **é™æ€ç”Ÿæˆ**: å…¬å…±é¡µé¢ä½¿ç”¨ SSG
4. **ç¼“å­˜ç­–ç•¥**: React Query ç¼“å­˜ API å“åº”

### åç«¯ä¼˜åŒ–

1. **æ•°æ®åº“ç´¢å¼•**: ä¸ºå¸¸ç”¨æŸ¥è¯¢å­—æ®µæ·»åŠ ç´¢å¼•
2. **è¿æ¥æ± **: é…ç½®æ•°æ®åº“è¿æ¥æ± 
3. **å¼‚æ­¥å¤„ç†**: è€—æ—¶æ“ä½œä½¿ç”¨åå°ä»»åŠ¡
4. **API ç¼“å­˜**: Redis ç¼“å­˜çƒ­ç‚¹æ•°æ®

---

## ğŸ”’ å®‰å…¨æªæ–½

1. **è®¤è¯**: JWT Token è®¤è¯
2. **æˆæƒ**: åŸºäºè§’è‰²çš„è®¿é—®æ§åˆ¶ï¼ˆRBACï¼‰
3. **CORS**: é…ç½®å…è®¸çš„æ¥æº
4. **SQL æ³¨å…¥é˜²æŠ¤**: ä½¿ç”¨ ORM å‚æ•°åŒ–æŸ¥è¯¢
5. **XSS é˜²æŠ¤**: React è‡ªåŠ¨è½¬ä¹‰
6. **HTTPS**: ç”Ÿäº§ç¯å¢ƒå¼ºåˆ¶ HTTPS
7. **å¯†ç åŠ å¯†**: Bcrypt å“ˆå¸Œ

---

## ğŸ“ˆ æ‰©å±•æ€§è€ƒè™‘

### æ°´å¹³æ‰©å±•

- å‰ç«¯: éƒ¨ç½²å¤šä¸ªå®ä¾‹ + è´Ÿè½½å‡è¡¡
- åç«¯: ä½¿ç”¨ Gunicorn å¤šè¿›ç¨‹ + Nginx è´Ÿè½½å‡è¡¡
- æ•°æ®åº“: ä¸»ä»å¤åˆ¶ + è¯»å†™åˆ†ç¦»

### AI æœåŠ¡é›†æˆ

```python
# é€‚é…å™¨æ¨¡å¼æ”¯æŒå¤š AI å¹³å°
class AIProviderAdapter:
    @abstractmethod
    async def chat(self, messages):
        pass

class CozeProvider(AIProviderAdapter):
    async def chat(self, messages):
        # æ‰£å­ API è°ƒç”¨
        pass

class ZhipuProvider(AIProviderAdapter):
    async def chat(self, messages):
        # æ™ºè°± API è°ƒç”¨
        pass
```

---

## ğŸ¯ åç»­æ¶æ„æ¼”è¿›

### Phase 1: å¾®æœåŠ¡åŒ–ï¼ˆå¯é€‰ï¼‰
- æ‹†åˆ† AI æœåŠ¡ä¸ºç‹¬ç«‹å¾®æœåŠ¡
- ä½¿ç”¨æ¶ˆæ¯é˜Ÿåˆ—ï¼ˆRabbitMQ/Redisï¼‰

### Phase 2: å®æ—¶é€šä¿¡
- WebSocket æ”¯æŒå®æ—¶å¯¹è¯
- Redis Pub/Sub å¤šå®ä¾‹é€šä¿¡

### Phase 3: å¤§æ•°æ®åˆ†æ
- å­¦ä¹ æ•°æ®åˆ†æå¹³å°
- ä½¿ç”¨ Spark/Flink å¤„ç†å¤§è§„æ¨¡æ•°æ®

---

æœ¬æ¶æ„æ–‡æ¡£ä¼šéšé¡¹ç›®å‘å±•æŒç»­æ›´æ–°ã€‚

